require File.join(File.dirname(__FILE__),"../config.rb")

service_item "Service Item Example with Person Lookup" do
  catalog CATALOG_NAME
  categories "Example Templates, Example Templates :: Example Templates Subcategory"
  type "Template"
  description "Service Item template with Simple Data Request search for requestor and contact"
  display_page DISPLAY_PAGE
  display_name nil
  web_server WEB_SERVER
  authentication :default
  page "Initial Page",
    :contents,
    :vertical_buttons,
    :submit_button_value => "Submit" do
    section  "Section Example",
      :style_class => " border rounded "
    text "Section Example Title", "Section Example",
      :style_class => " sectionHeader "
    text "Service Item Description", "<p>\nReplace this text with a brief desciption of this service item.\n</p>"
    section  "Submitter",
      :removed
    text "Submitter Header", "Submitter Information",
      :style_class => " primaryColorHeader "
    question "Requester First Name", "Requester First Name", :free_text,
      :required,
      :advance_default,
      :editor_label => "Req First Name",
      :default_form => "CTM:People",
      :default_field => "First Name",
      :default_qual => "$\\USER$= 'Remedy Login ID'",
      :size => "20",
      :rows => "1",
      :max => "50",
      :required_text => "Requester First Name",
      :field_map_number => "1"
    question "Requester Last Name", "Requester Last Name", :free_text,
      :required,
      :advance_default,
      :editor_label => "Req Last Name",
      :default_form => "CTM:People",
      :default_field => "Last Name",
      :default_qual => "$\\USER$= 'Remedy Login ID'",
      :size => "20",
      :rows => "1",
      :max => "100",
      :required_text => "Requester Last Name",
      :field_map_number => "2"
    question "Requester People Number", "Requester People Number", :free_text,
      :advance_default,
      :editor_label => "Req People #",
      :default_form => "CTM:People",
      :default_field => "Person ID",
      :default_qual => "$\\USER$= 'Remedy Login ID'",
      :size => "20",
      :rows => "1",
      :max => "20",
      :field_map_number => "3"
    question "Requester Email Address", "Requester Email", :email,
      :required,
      :advance_default,
      :editor_label => "Req Email Address",
      :default_form => "CTM:People",
      :default_field => "Internet E-mail",
      :default_qual => "$\\USER$= 'Remedy Login ID'",
      :size => "20",
      :required_text => "Requester Email",
      :pattern_label => "Standard Email Address",
      :pattern => "^[\\w-\\.]+\\@[\\w\\.-]+\\.[a-zA-Z]{2,4}$",
      :validation_text => "Requester Email Address (Standard Email Address)",
      :field_map_number => "4"
    question "Req Login ID", "Requester Login ID", :free_text,
      :advance_default,
      :default_form => "CTM:People",
      :default_field => "Remedy Login ID",
      :default_qual => "$\\USER$= 'Remedy Login ID'",
      :size => "20",
      :rows => "1",
      :field_map_number => "7"
    section  "Requested For Section",
      :style_class => " border rounded "
    text "Requested For Header", "Requested For",
      :style_class => " sectionHeader "
    question "This Request is for", "This Request is for", :list,
      :radio_button,
      :horizontal,
      :required,
      :editor_label => "This Request is For",
      :default_answer => "Myself",
      :choice_list => "This Request is For",
      :field_map_number => "9" do
      choice "Myself", "Myself&nbsp;&nbsp;"
      choice "Another Employee"
      event "Show requested for content",
        :insert_remove,
        :click,
        :fire_if => "obj.value== \"Another Employee\"  && clientManager.submitType != \"ReviewRequest\"" do
        target "Search By Last Name",
          :question,
          :insert
        target "Search Buttons",
          :text,
          :insert
      end
      event "Show Req For Details Section",
        :insert_remove,
        :click,
        :fire_if => "obj.value == \"Another Employee\"" do
        target "Requested For Details Section",
          :section,
          :insert
      end
      event "Clear requested for questions",
        :set_fields_internal,
        :click,
        :fire_if => "obj.value== \"Another Employee\" && clientManager.submitType !=\"ReviewRequest\" && !KD.utils.ClientManager.isLoading" do
        field_map "ReqFor_Login ID", "$\\NULL$"
        field_map "ReqFor_First Name", "$\\NULL$"
        field_map "ReqFor_Last Name", "$\\NULL$"
        field_map "ReqFor_Phone", "$\\NULL$"
        field_map "ReqFor_Email", "$\\NULL$"
        field_map "ReqFor_Org", "$\\NULL$"
        field_map "ReqFor_Dept", "$\\NULL$"
        field_map "ReqFor_VIP", "$\\NULL$"
      end
      event "Set requested for fields when me is chosen",
        :set_fields_external,
        :click,
        :fire_if => "obj.value == \"Myself\"  && clientManager.submitType !=\"ReviewRequest\" && (clientManager.isNewPage == true || clientManager.isLoading==false)" do
        data_request "CTM:People",
          :sort_fields => "",
          :max_entries => "1",
          :sort_order => "Ascending",
          :qualification => "'Remedy Login ID'= \"$\\USER$\""
        field_map "ReqFor_Login ID", "<FLD>Remedy Login ID</FLD> ",
          :fire_change_event,
          :visible_in_table => "Yes",
          :table_label => "Login ID"
        field_map "ReqFor_Phone", "<FLD>Phone Number Business</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Phone"
        field_map "ReqFor_Email", "<FLD>Internet E-mail</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Email"
        field_map "ReqFor_First Name", "<FLD>First Name</FLD> ",
          :visible_in_table => "Yes"
        field_map "ReqFor_Last Name", "<FLD>Last Name</FLD> ",
          :visible_in_table => "Yes"
        field_map "ReqFor_Org", "<FLD>Organization</FLD> ",
          :visible_in_table => "No"
        field_map "ReqFor_Dept", "<FLD>Department</FLD> ",
          :visible_in_table => "Yes"
        field_map "ReqFor_VIP", "<FLD>VIP</FLD> ",
          :visible_in_table => "No"
      end
    end
    question "Search By Last Name", "Last Name", :free_text,
      :removed,
      :transient,
      :size => "40",
      :rows => "1",
      :style_class => " fleft "
    text "Search Buttons", "<div class=\"fleft\" id=\"searchButtons\">\n  <input type=\"button\" value=\"Search\" id=\"b_searchReqFor\" class=\"templateButton\" > \n  <input type=\"button\" value=\"Clear\" id=\"b_clearReqFor\" class=\"templateButton\" > \n  <img id=\"ajax_searchReqFor\" src=\"themes/flyout/common/resources/images/spinner.gif\" alt=\"searching...\" style=\"display:none;\" />\n</div>\n<div class=\"clearfix\"></div>",
      :removed,
      :style_class => " fleft " do
      event "Person Lookup",
        :set_fields_external,
        :click,
        :fire_if => "1==1" do
        data_request "CTM:People",
          :sort_fields => "Last Name",
          :max_entries => "100",
          :sort_order => "Ascending",
          :qualification => "'Last Name'  LIKE \"<FLD>Search By Last Name;KS078dd14a3ed2682cc64b354a1ef666913d;ANSWER</FLD>%\""
        field_map "ReqFor_First Name", "<FLD>First Name</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "First Name"
        field_map "ReqFor_Last Name", "<FLD>Last Name</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Last Name"
        field_map "ReqFor_Login ID", "<FLD>Remedy Login ID</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Login ID"
        field_map "ReqFor_Phone", "<FLD>Phone Number Business</FLD> ",
          :visible_in_table => "No"
        field_map "Req Email Address", "<FLD>Internet E-mail</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Email"
        field_map "ReqFor_Org", "<FLD>Organization</FLD> ",
          :visible_in_table => "No"
        field_map "ReqFor_Dept", "<FLD>Department</FLD> ",
          :visible_in_table => "No"
        field_map "ReqFor_VIP", "<FLD>VIP</FLD> ",
          :visible_in_table => "No"
      end
    end
    section  "Requested For Details Section",
      :removed,
      :style_class => " border rounded "
    question "Requested For Login ID", "Requested For Login ID", :free_text,
      :required,
      :editor_label => "ReqFor_Login ID",
      :size => "40",
      :rows => "1",
      :field_map_number => "11"
    question "Requested For First Name", "First Name", :free_text,
      :editor_label => "ReqFor_First Name",
      :size => "40",
      :rows => "1",
      :field_map_number => "12"
    question "Requested For Last Name", "Last Name", :free_text,
      :editor_label => "ReqFor_Last Name",
      :size => "40",
      :rows => "1",
      :field_map_number => "13"
    question "Requested For Email", "Email Address", :free_text,
      :editor_label => "ReqFor_Email",
      :size => "40",
      :rows => "1",
      :field_map_number => "14"
    question "Requested For Phone Number", "Phone Number", :free_text,
      :editor_label => "ReqFor_Phone",
      :size => "40",
      :rows => "1",
      :field_map_number => "15"
    question "ReqFor_Org", "Office", :free_text,
      :size => "40",
      :rows => "1",
      :field_map_number => "28"
    question "ReqFor_Dept", "Branch", :free_text,
      :size => "40",
      :rows => "1",
      :field_map_number => "6"
    question "ReqFor_VIP", "VIP", :free_text,
      :removed,
      :size => "20",
      :rows => "1",
      :field_map_number => "10"
    section  "Contact Section",
      :style_class => " border rounded "
    text "Contact Header", "Contact Information",
      :style_class => " sectionHeader "
    question "The Contact for this request is", "The Contact for this request is", :list,
      :radio_button,
      :horizontal,
      :required,
      :editor_label => "Contact is",
      :default_answer => "Myself",
      :choice_list => "This Request is For",
      :field_map_number => "16" do
      event "Set contact fields when me is chosen",
        :set_fields_external,
        :click,
        :fire_if => "obj.value == \"Myself\"  && clientManager.submitType !=\"ReviewRequest\" && (clientManager.isNewPage == true || clientManager.isLoading==false)" do
        data_request "CTM:People",
          :sort_fields => "",
          :max_entries => "1",
          :sort_order => "Ascending",
          :qualification => "'Remedy Login ID'= \"$\\USER$\""
        field_map "Contact_Email", "<FLD>Internet E-mail</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Email"
        field_map "Contact_Phone", "<FLD>Phone Number Business</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Phone"
        field_map "Contact_First Name", "<FLD>First Name</FLD> ",
          :visible_in_table => "Yes"
        field_map "Contact_Last Name", "<FLD>Last Name</FLD> ",
          :visible_in_table => "Yes"
        field_map "Contact_Login ID", "<FLD>Remedy Login ID</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Login ID"
      end
      event "Show Contact Details",
        :insert_remove,
        :click,
        :fire_if => "obj.value== \"Another Employee\"" do
        target "Contact Details Section",
          :section,
          :insert
      end
      event "Show contact content",
        :insert_remove,
        :click,
        :fire_if => "obj.value== \"Another Employee\" && clientManager.submitType !=\"ReviewRequest\"" do
        target "Contact Search By Last Name",
          :question,
          :insert
        target "Contact Search Buttons",
          :text,
          :insert
      end
      event "Clear Contact fields",
        :set_fields_internal,
        :click,
        :fire_if => "obj.value== \"Another Employee\" && clientManager.submitType !=\"ReviewRequest\" && !KD.utils.ClientManager.isLoading" do
        field_map "Contact Search By Last Name", "$\\NULL$"
        field_map "Contact_Email", "$\\NULL$"
        field_map "Contact_Phone", "$\\NULL$"
        field_map "Contact_Login ID", "$\\NULL$"
        field_map "Contact_Last Name", "$\\NULL$"
        field_map "Contact_First Name", "$\\NULL$"
      end
    end
    question "Contact Search By Last Name", "Last Name", :free_text,
      :removed,
      :transient,
      :size => "40",
      :rows => "1",
      :style_class => " fleft "
    text "Contact Search Buttons", "<div id=\"searchButtons\" class= \"fleft\">\n  <input type=\"button\" value=\"Search\" id=\"b_searchContact\" class=\"templateButton\" > \n  <input type=\"button\" value=\"Clear\" id=\"b_clearContact\" class=\"templateButton\" > \n<img id=\"ajax_searchContact\" src=\"themes/flyout/common/resources/images/spinner.gif\" alt=\"searching...\" style=\"display:none;\" />\n</div>\n<div class=\"clearfix\"></div>\n\n",
      :removed,
      :style_class => " fleft " do
      event "Contact Person Lookup",
        :set_fields_external,
        :click,
        :fire_if => "1==1" do
        data_request "CTM:People",
          :sort_fields => "",
          :max_entries => "100",
          :sort_order => "Ascending",
          :qualification => "'Last Name' LIKE \"<FLD>Contact Search By Last Name;KS065435cdd8d077c841a2d62b211befc70c;ANSWER</FLD>%\""
        field_map "Contact_Login ID", "<FLD>Remedy Login ID</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Login ID"
        field_map "Contact_First Name", "<FLD>First Name</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "First Name"
        field_map "Contact_Last Name", "<FLD>Last Name</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "Last Name"
        field_map "Contact_Email", "<FLD>Internet E-mail</FLD> ",
          :visible_in_table => "Yes",
          :table_label => "E-mail"
        field_map "Contact_Phone", "<FLD>Phone Number Business</FLD> ",
          :visible_in_table => "No"
      end
    end
    section  "Contact Details Section",
      :removed,
      :style_class => " border rounded "
    question "Contact Login ID", "Contact Login ID", :free_text,
      :required,
      :editor_label => "Contact_Login ID",
      :size => "40",
      :rows => "1",
      :field_map_number => "18"
    question "Contact First Name", "First Name", :free_text,
      :editor_label => "Contact_First Name",
      :size => "40",
      :rows => "1",
      :field_map_number => "19"
    question "Contact Last Name", "Last Name", :free_text,
      :editor_label => "Contact_Last Name",
      :size => "40",
      :rows => "1",
      :field_map_number => "20"
    question "Contact Email", "Email Address", :free_text,
      :editor_label => "Contact_Email",
      :size => "40",
      :rows => "1",
      :field_map_number => "21"
    question "Contact Phone Number", "Phone Number", :free_text,
      :editor_label => "Contact_Phone",
      :size => "40",
      :rows => "1",
      :field_map_number => "22"
    section  "Questions",
      :style_class => " border rounded "
    text "Service Questions", "Please answer the following questions",
      :style_class => " sectionHeader "
    question "Summary", "Summary", :free_text,
      :size => "20",
      :rows => "1",
      :field_map_number => "5"
    question "Notes", "Notes", :free_text,
      :size => "40",
      :rows => "6",
      :field_map_number => "8"
  end
  page "Confirmation Page",
    :confirmation,
    :vertical_buttons,
    :display_page => CONFIRMATION_PAGE do
    section  "Details"
  end
  task_tree "Loaner Laptop - ITC, SO, COTR",
    :type => "Complete",
    :xml => "<taskTree schema_version=\"1.0\" version=\"\" builder_version=\"1.0.0\">\n  <name>Loaner Laptop - ITC, SO, COTR</name>\n  <author/>\n  <notes/>\n  <lastID>143</lastID>\n  <request>\n    <task name=\"1st 2nd and 3rd Approval-2012-08-11\" id=\"system_noop_v1_110\" definition_id=\"system_noop_v1\" x=\"350\" y=\"10\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters/>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"1st Approval Complete\" id=\"system_noop_v1_102\" definition_id=\"system_noop_v1\" x=\"10\" y=\"1080\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters/>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Request greater than 10 days\" value=\"&lt;%=@results['Calculate Duration']['output']%> > 10\">kinetic_request_submission_update_status_v1_132</task>\n        <task type=\"Complete\" label=\"Request less than 10 days\" value=\"&lt;%=@results['Calculate Duration']['output']%> &lt;= 10\">system_noop_v1_141</task>\n      </dependents>\n    </task>\n    <task name=\"1st Approval Lookup\" id=\"bmc_itsm7_approver_lookup_v2_69\" definition_id=\"bmc_itsm7_approver_lookup_v2\" x=\"860\" y=\"230\">\n      <version>2</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"remedy_login_id\" tooltip=\"The AR Login associated to the CTM People record to retrieve\" label=\"Remedy Login ID\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%= @appr %&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_create_v3_86</task>\n      </dependents>\n    </task>\n    <task name=\"1st Approval Needed\" id=\"system_noop_v1_111\" definition_id=\"system_noop_v1\" x=\"330\" y=\"230\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters/>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_head_v1_62</task>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_echo_v1_124</task>\n      </dependents>\n    </task>\n    <task name=\"1st Approvals Head\" id=\"system_loop_head_v1_62\" definition_id=\"system_loop_head_v1\" x=\"600\" y=\"230\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"data_source\" tooltip=\"The source that contains the data to use to create each task in the loop.\" label=\"Data Source:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Lookup 1st Approvers']['approverList']%&gt;</parameter>\n        <parameter id=\"loop_path\" tooltip=\"The XPath statement to indicate what data records to process.\" label=\"Loop Path:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">//approvers/approver</parameter>\n        <parameter id=\"var_name\" tooltip=\"The local variable name used to represent the data used in loop tasks.\" label=\"Variable Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">appr</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_lookup_v2_69</task>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_tail_v1_64</task>\n      </dependents>\n    </task>\n    <task name=\"1st Approvals Tail\" id=\"system_loop_tail_v1_64\" definition_id=\"system_loop_tail_v1\" x=\"600\" y=\"340\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"type\" tooltip=\"How many loop processes must be completed before continuing?\" label=\"Type:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"All,Some,Any\">Any</parameter>\n        <parameter id=\"number\" tooltip=\"If some, how many?\" label=\"Number:\" required=\"\" dependsOnId=\"type\" dependsOnValue=\"Some\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Approved\" value=\"\">system_join_v1_112</task>\n      </dependents>\n    </task>\n    <task name=\"2nd Approval Head\" id=\"system_loop_head_v1_114\" definition_id=\"system_loop_head_v1\" x=\"510\" y=\"1250\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"data_source\" tooltip=\"The source that contains the data to use to create each task in the loop.\" label=\"Data Source:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Lookup 2nd Approvers']['approverList']%&gt;</parameter>\n        <parameter id=\"loop_path\" tooltip=\"The XPath statement to indicate what data records to process.\" label=\"Loop Path:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">//approvers/approver</parameter>\n        <parameter id=\"var_name\" tooltip=\"The local variable name used to represent the data used in loop tasks.\" label=\"Variable Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">appr</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_tail_v1_115</task>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_lookup_v2_116</task>\n      </dependents>\n    </task>\n    <task name=\"2nd Approval Lookup\" id=\"bmc_itsm7_approver_lookup_v2_116\" definition_id=\"bmc_itsm7_approver_lookup_v2\" x=\"740\" y=\"1250\">\n      <version>2</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"remedy_login_id\" tooltip=\"The AR Login associated to the CTM People record to retrieve\" label=\"Remedy Login ID\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%= @appr %&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_create_v3_133</task>\n      </dependents>\n    </task>\n    <task name=\"2nd Approval Tail\" id=\"system_loop_tail_v1_115\" definition_id=\"system_loop_tail_v1\" x=\"510\" y=\"1390\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"type\" tooltip=\"How many loop processes must be completed before continuing?\" label=\"Type:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"All,Some,Any\">Any</parameter>\n        <parameter id=\"number\" tooltip=\"If some, how many?\" label=\"Number:\" required=\"\" dependsOnId=\"type\" dependsOnValue=\"Some\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_expire_v1_125</task>\n      </dependents>\n    </task>\n    <task name=\"3rd Approval Head\" id=\"system_loop_head_v1_130\" definition_id=\"system_loop_head_v1\" x=\"500\" y=\"1630\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"data_source\" tooltip=\"The source that contains the data to use to create each task in the loop.\" label=\"Data Source:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Lookup 3rd Approvers']['approverList']%&gt;</parameter>\n        <parameter id=\"loop_path\" tooltip=\"The XPath statement to indicate what data records to process.\" label=\"Loop Path:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">//approvers/approver</parameter>\n        <parameter id=\"var_name\" tooltip=\"The local variable name used to represent the data used in loop tasks.\" label=\"Variable Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">appr</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_tail_v1_127</task>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_lookup_v2_129</task>\n      </dependents>\n    </task>\n    <task name=\"3rd Approval Lookup\" id=\"bmc_itsm7_approver_lookup_v2_129\" definition_id=\"bmc_itsm7_approver_lookup_v2\" x=\"720\" y=\"1630\">\n      <version>2</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"remedy_login_id\" tooltip=\"The AR Login associated to the CTM People record to retrieve\" label=\"Remedy Login ID\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%= @appr %&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_create_v3_85</task>\n      </dependents>\n    </task>\n    <task name=\"3rd Approval Tail\" id=\"system_loop_tail_v1_127\" definition_id=\"system_loop_tail_v1\" x=\"510\" y=\"1780\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"type\" tooltip=\"How many loop processes must be completed before continuing?\" label=\"Type:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"All,Some,Any\">Any</parameter>\n        <parameter id=\"number\" tooltip=\"If some, how many?\" label=\"Number:\" required=\"\" dependsOnId=\"type\" dependsOnValue=\"Some\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_expire_v1_126</task>\n      </dependents>\n    </task>\n    <task name=\"Agency Wide Approval\" id=\"kinetic_request_approval_create_v3_105\" definition_id=\"kinetic_request_approval_create_v3\" x=\"800\" y=\"700\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"approver_login\" tooltip=\"The Remedy login name of the approver.\" label=\"Approver Login:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Agency Wide Approver Lookup']['Remedy Login ID']%&gt;</parameter>\n        <parameter id=\"approver_email\" tooltip=\"The email address of the approver.\" label=\"Approver Email:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Agency Wide Approver Lookup']['Email']%&gt;</parameter>\n        <parameter id=\"approver_first_name\" tooltip=\"The first name of the approver.\" label=\"Approver First Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Agency Wide Approver Lookup']['First Name']%&gt;</parameter>\n        <parameter id=\"approver_last_name\" tooltip=\"The last name of the approver.\" label=\"Approver Last Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Agency Wide Approver Lookup']['Last Name']%&gt;</parameter>\n        <parameter id=\"message_template_name\" tooltip=\"The name of the message template to use for the approval.  If no message template is provided an email will not be sent.\" label=\"Message Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"approval_template_catalog_name\" tooltip=\"The name of the catalog the template for approval belongs to.\" label=\"Approval Template Catalog Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['Category']%&gt;</parameter>\n        <parameter id=\"approval_template_name\" tooltip=\"The name of the template to use for the approval.\" label=\"Approval Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Agency Wide Approve Request</parameter>\n        <parameter id=\"approval_question_label\" tooltip=\"The menu label of the service item question that is used to determine the result of the approval.\" label=\"Approval Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Is this request approved?</parameter>\n        <parameter id=\"approval_value\" tooltip=\"The value that denotes an approval.\" label=\"Approved Value:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Approved</parameter>\n        <parameter id=\"denial_comments_question_label\" tooltip=\"The menu label of the service item question that is used to generate the denial comments.\" label=\"Denial Comments Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Reason for Denial</parameter>\n        <parameter id=\"lookup_id\" tooltip=\"The instance id of the Kinetic Request submission that is being approved.\" label=\"Lookup Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n        <parameter id=\"notes_for_customer\" tooltip=\"Text that can be displayed to customer (typically from the Service Catalog page).  This is stored on the 'Customer Notes' field on the KS_SRV_CustomerSurvey_base form.\" label=\"Notes For Customer:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\">&lt;b&gt;Approval Sent to:&lt;/b&gt; &lt;%=@results['Agency Wide Approver Lookup']['Remedy Login ID']%&gt; (&lt;%=@results['Agency Wide Approver Lookup']['First Name']%&gt; &lt;%=@results['Agency Wide Approver Lookup']['Last Name']%&gt;)</message>\n        <message type=\"Update\">&lt;%=@results['Agency Wide Approval']['Validation Status']%&gt;</message>\n        <message type=\"Complete\">&lt;b&gt;&lt;%=@results['Agency Wide Approval']['Validation Status']%&gt;&lt;/b&gt;; &lt;%=@results['Agency Wide Approval']['Denial Reason']%&gt;</message>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Approved\" value=\"&quot;&lt;%=@results['Agency Wide Approval']['Validation Status']%>&quot; == &quot;Approved&quot;\">system_loop_tail_v1_107</task>\n        <task type=\"Complete\" label=\"Denied\" value=\"&quot;&lt;%=@results['Agency Wide Approval']['Validation Status']%>&quot; == &quot;Denied&quot;\">kinetic_request_submission_close_v1_52</task>\n      </dependents>\n    </task>\n    <task name=\"Agency Wide Approver Lookup\" id=\"bmc_itsm7_approver_lookup_v2_106\" definition_id=\"bmc_itsm7_approver_lookup_v2\" x=\"820\" y=\"590\">\n      <version>2</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"remedy_login_id\" tooltip=\"The AR Login associated to the CTM People record to retrieve\" label=\"Remedy Login ID\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%= @AWappr %&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_create_v3_105</task>\n      </dependents>\n    </task>\n    <task name=\"Approval Given\" id=\"system_join_v1_112\" definition_id=\"system_join_v1\" x=\"1290\" y=\"780\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"type\" tooltip=\"How many dependents must be completed before continuing?\" label=\"Type:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"All,Any,Some\">Any</parameter>\n        <parameter id=\"number\" tooltip=\"If some, how many?\" label=\"Number:\" required=\"false\" dependsOnId=\"type\" dependsOnValue=\"Some\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_expire_v1_70</task>\n      </dependents>\n    </task>\n    <task name=\"Approvals Complete\" id=\"system_noop_v1_141\" definition_id=\"system_noop_v1\" x=\"20\" y=\"1730\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters/>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_eval_v1_74</task>\n      </dependents>\n    </task>\n    <task name=\"Calculate Duration\" id=\"utilities_echo_v1_142\" definition_id=\"utilities_echo_v1\" x=\"440\" y=\"120\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%\rfullDuration = (Date.parse(@answers['End Date']) - Date.parse(@answers['Start Date'])).to_i\rfirstDay =  Date.parse(@answers['Start Date']).wday\rtoday = firstDay\rdays = 1\rduration = 0\rwhile (days &lt; fullDuration)\r  if (today != 0 &amp;&amp; today != 7)\r     duration += 1\r  end\r  days +=1\r  today +=1\r  if (today == 8)\r      today = 0\r  end\rend\r%&gt;&lt;%=duration%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_retrieve_nrc_v3_109</task>\n      </dependents>\n    </task>\n    <task name=\"Calculate Wait Days_AGENCY WIDE\" id=\"utilities_echo_v1_123\" definition_id=\"utilities_echo_v1\" x=\"330\" y=\"340\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=\nexpire=4\ncase @results['Get Weekday']['result'].to_i()\nwhen 0\n   5\nwhen 1\n   4\nwhen 2 \n   4\nwhen 3\n   6\nwhen 4\n   6\nwhen 5\n   5\nwhen 6\n   6\nend\n%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_wait_v1_101</task>\n      </dependents>\n    </task>\n    <task name=\"Calculate Wait Days_SAM\" id=\"utilities_echo_v1_152\" definition_id=\"utilities_echo_v1\" x=\"110\" y=\"680\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%= \nwaitDays = 4\nday = Date.today.wday + waitDays\nwhile (day % 7 == 0) or (day % 7 == 6) do\nday +=1\nwaitDays +=1\nend\nwaitDays\n%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_wait_v1_153</task>\n      </dependents>\n    </task>\n    <task name=\"Change\" id=\"bmc_itsm7_change_templated_create_v4_104\" definition_id=\"bmc_itsm7_change_templated_create_v4\" x=\"750\" y=\"1920\">\n      <version>4</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"change_template_name\" tooltip=\"The name of the change template to be used.  Change templates are retrieved from CHG:Template.\" label=\"Change Template Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Set Change Template']['result']%&gt;</parameter>\n        <parameter id=\"requester_first_name\" tooltip=\"Sets the First Name on the Requester tab under the Requested By header.\" label=\"Requester First Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['ReqFor_First Name']%&gt;</parameter>\n        <parameter id=\"requester_last_name\" tooltip=\"Sets the Last Name on the Requester tab under the Requested By header.\" label=\"Requester Last Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['ReqFor_Last Name']%&gt;</parameter>\n        <parameter id=\"requester_support_company\" tooltip=\"Sets the Support Company on the Requester tab under the Requested By header.\" label=\"Requester Support Company:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">NRC</parameter>\n        <parameter id=\"submitter_login_id\" tooltip=\"Sets the Submitter on the Dates tab under the Change Dates header.\" label=\"Submitter Login Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['Req Login ID']%&gt;</parameter>\n        <parameter id=\"change_notes\" tooltip=\"Appends to the Notes field of the Change.\" label=\"Change Notes:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Format Answers HTML']['textresult']%&gt;\r\rReview Request at &lt;%=@appconfig['Default Web Server']%&gt;ReviewRequest?csrv=&lt;%=@dataset['CustomerSurveyInstanceId']%&gt;&amp;reviewPage=/themes/nrc/packages/base/review</parameter>\n        <parameter id=\"change_status\" tooltip=\"Sets the status field of the Change.\" label=\"Change Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Draft</parameter>\n        <parameter id=\"scheduled_start_date\" tooltip=\"Sets the Scheduled Start Date on the Date/System tab--required if status is scheduled or greater.\" label=\"Change Scheduled Start Date\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Set Start Date']['output']%&gt;</parameter>\n        <parameter id=\"scheduled_end_date\" tooltip=\"Sets the Scheduled End Date on the Date/System tab--required if status is scheduled or greater.\" label=\"Change Scheduled End Date\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Set End Date']['output']%&gt;</parameter>\n        <parameter id=\"requested_start_date\" tooltip=\"Sets the Requested Start Date on the Date/System tab.\" label=\"Change Requested Start Date\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"requested_end_date\" tooltip=\"Sets the Requested End Date on the Date/System tab.\" label=\"Change Requested End Date\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\">Processed &lt;%=@results['Change']['Change Number']%&gt;</message>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_echo_v1_98</task>\n        <task type=\"Create\" label=\"\" value=\"\">kinetic_request_submission_update_status_v1_45</task>\n        <task type=\"Create\" label=\"\" value=\"\">bmc_itsm7_change_work_info_create_v3_44</task>\n      </dependents>\n    </task>\n    <task name=\"Close Request_chg\" id=\"kinetic_request_submission_close_v1_48\" definition_id=\"kinetic_request_submission_close_v1\" x=\"720\" y=\"2150\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The value the Validation Status field on the specified Kinetic Request submission record will be set to.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Set Change Status']['output']%&gt;</parameter>\n        <parameter id=\"submission_id\" tooltip=\"The instance id of the Kinetic Request submission to be updated.\" label=\"Submission Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"Close Request_denied\" id=\"kinetic_request_submission_close_v1_52\" definition_id=\"kinetic_request_submission_close_v1\" x=\"1280\" y=\"600\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The value the Validation Status field on the specified Kinetic Request submission record will be set to.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Request Denied</parameter>\n        <parameter id=\"submission_id\" tooltip=\"The instance id of the Kinetic Request submission to be updated.\" label=\"Submission Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_expire_v1_88</task>\n      </dependents>\n    </task>\n    <task name=\"Create Agency Wide Approvals Loop Head\" id=\"system_loop_head_v1_104\" definition_id=\"system_loop_head_v1\" x=\"550\" y=\"590\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"data_source\" tooltip=\"The source that contains the data to use to create each task in the loop.\" label=\"Data Source:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Lookup Agency Wide Approvers']['approverList']%&gt;</parameter>\n        <parameter id=\"loop_path\" tooltip=\"The XPath statement to indicate what data records to process.\" label=\"Loop Path:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">//approvers/approver</parameter>\n        <parameter id=\"var_name\" tooltip=\"The local variable name used to represent the data used in loop tasks.\" label=\"Variable Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">AWappr</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_tail_v1_107</task>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_lookup_v2_106</task>\n      </dependents>\n    </task>\n    <task name=\"Create Agency Wide Approvals Loop Tail\" id=\"system_loop_tail_v1_107\" definition_id=\"system_loop_tail_v1\" x=\"550\" y=\"700\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"type\" tooltip=\"How many loop processes must be completed before continuing?\" label=\"Type:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"All,Some,Any\">Any</parameter>\n        <parameter id=\"number\" tooltip=\"If some, how many?\" label=\"Number:\" required=\"\" dependsOnId=\"type\" dependsOnValue=\"Some\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Approved\" value=\"\">system_join_v1_112</task>\n      </dependents>\n    </task>\n    <task name=\"Create SAMS Approvals Loop Head\" id=\"system_loop_head_v1_126\" definition_id=\"system_loop_head_v1\" x=\"560\" y=\"830\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"data_source\" tooltip=\"The source that contains the data to use to create each task in the loop.\" label=\"Data Source:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Lookup SAMS']['approverList']%&gt;</parameter>\n        <parameter id=\"loop_path\" tooltip=\"The XPath statement to indicate what data records to process.\" label=\"Loop Path:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">//approvers/approver</parameter>\n        <parameter id=\"var_name\" tooltip=\"The local variable name used to represent the data used in loop tasks.\" label=\"Variable Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">SAMSappr</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_lookup_v2_127</task>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_tail_v1_129</task>\n      </dependents>\n    </task>\n    <task name=\"Create SAMS Approvals Loop Tail\" id=\"system_loop_tail_v1_129\" definition_id=\"system_loop_tail_v1\" x=\"570\" y=\"980\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"type\" tooltip=\"How many loop processes must be completed before continuing?\" label=\"Type:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"All,Some,Any\">Any</parameter>\n        <parameter id=\"number\" tooltip=\"If some, how many?\" label=\"Number:\" required=\"\" dependsOnId=\"type\" dependsOnValue=\"Some\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Approved\" value=\"\">system_join_v1_112</task>\n      </dependents>\n    </task>\n    <task name=\"Create Work Info\" id=\"bmc_itsm7_change_work_info_create_v3_44\" definition_id=\"bmc_itsm7_change_work_info_create_v3\" x=\"960\" y=\"2040\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"change_number\" tooltip=\"The change number of the Change to associate the Change Work Info entry with.\" label=\"Change Number:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Change']['Change Number']%&gt;</parameter>\n        <parameter id=\"include_review_request\" tooltip=\"Option to prepend the review request URL to the Notes of the Change Work Info entry.\" label=\"Include Review Request:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"Yes,No\">Yes</parameter>\n        <parameter id=\"include_question_answers\" tooltip=\"Option to append the question answer pairs to the Notes of the Change Work Info entry.\" label=\"Include Question Answers:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"Yes,No\">No</parameter>\n        <parameter id=\"work_info_summary\" tooltip=\"Sets the Summary of the Change Work Info entry.\" label=\"Work Info Summary:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Please process change:</parameter>\n        <parameter id=\"work_info_notes\" tooltip=\"Sets the Notes of the Change Work Info entry.\" label=\"Work Info Notes:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">This ticket was created from Kinetic Request # &lt;%=@dataset['Originating ID-Display']%&gt;.\n\n&lt;%=@results['Format Answers HTML']['textresult']%&gt;</parameter>\n        <parameter id=\"work_info_submit_date\" tooltip=\"Sets the Date of the Change Work Info entry.\" label=\"Work Info Submit Date:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"attachment_question_menu_label_1\" tooltip=\"The menu label of an attachment question to retrieve an attachment from.\" label=\"Attachment Question Menu Label 1:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"attachment_question_menu_label_2\" tooltip=\"The menu label of an attachment question to retrieve an attachment from.\" label=\"Attachment Question Menu Label 2:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"attachment_question_menu_label_3\" tooltip=\"The menu label of an attachment question to retrieve an attachment from.\" label=\"Attachment Question Menu Label 3:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"submitter\" tooltip=\"Sets the Submitter of the Change Work Info entry.\" label=\"Submitter:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['Req Login ID']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"DSFG COTR Approval\" id=\"kinetic_request_approval_create_v3_85\" definition_id=\"kinetic_request_approval_create_v3\" x=\"730\" y=\"1770\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"approver_login\" tooltip=\"The Remedy login name of the approver.\" label=\"Approver Login:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['3rd Approval Lookup']['Remedy Login ID']%&gt;</parameter>\n        <parameter id=\"approver_email\" tooltip=\"The email address of the approver.\" label=\"Approver Email:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['3rd Approval Lookup']['Email']%&gt;</parameter>\n        <parameter id=\"approver_first_name\" tooltip=\"The first name of the approver.\" label=\"Approver First Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['3rd Approval Lookup']['First Name']%&gt;</parameter>\n        <parameter id=\"approver_last_name\" tooltip=\"The last name of the approver.\" label=\"Approver Last Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['3rd Approval Lookup']['Last Name']%&gt;</parameter>\n        <parameter id=\"message_template_name\" tooltip=\"The name of the message template to use for the approval.  If no message template is provided an email will not be sent.\" label=\"Message Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"approval_template_catalog_name\" tooltip=\"The name of the catalog the template for approval belongs to.\" label=\"Approval Template Catalog Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['Category']%&gt;</parameter>\n        <parameter id=\"approval_template_name\" tooltip=\"The name of the template to use for the approval.\" label=\"Approval Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">OIS Approve Request</parameter>\n        <parameter id=\"approval_question_label\" tooltip=\"The menu label of the service item question that is used to determine the result of the approval.\" label=\"Approval Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Is this request approved?</parameter>\n        <parameter id=\"approval_value\" tooltip=\"The value that denotes an approval.\" label=\"Approved Value:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Approved</parameter>\n        <parameter id=\"denial_comments_question_label\" tooltip=\"The menu label of the service item question that is used to generate the denial comments.\" label=\"Denial Comments Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Reason for Denial</parameter>\n        <parameter id=\"lookup_id\" tooltip=\"The instance id of the Kinetic Request submission that is being approved.\" label=\"Lookup Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n        <parameter id=\"notes_for_customer\" tooltip=\"Text that can be displayed to customer (typically from the Service Catalog page).  This is stored on the 'Customer Notes' field on the KS_SRV_CustomerSurvey_base form.\" label=\"Notes For Customer:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\">&lt;b&gt;Pending Approval of:&lt;/b&gt; &lt;%=@results['3rd Approval Lookup']['Remedy Login ID']%&gt; (&lt;%=@results['3rd Approval Lookup']['First Name']%&gt; &lt;%=@results['3rd Approval Lookup']['Last Name']%&gt;)</message>\n        <message type=\"Update\"/>\n        <message type=\"Complete\">&lt;b&gt;&lt;%=@results['DSFG COTR Approval']['Validation Status']%&gt;&lt;/b&gt;; &lt;%=@results['DSFG COTR Approval']['Denial Reason']%&gt;</message>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Denied\" value=\"&quot;&lt;%=@results['DSFG COTR Approval']['Validation Status']%>&quot; == &quot;Denied&quot;\">kinetic_request_submission_close_v1_52</task>\n        <task type=\"Complete\" label=\"Approved\" value=\"&quot;&lt;%=@results['DSFG COTR Approval']['Validation Status']%>&quot; == &quot;Approved&quot;\">system_loop_tail_v1_127</task>\n      </dependents>\n    </task>\n    <task name=\"EXAMPLE: Set End to 7 am of date requested\" id=\"utilities_echo_v1_138\" definition_id=\"utilities_echo_v1\" x=\"1490\" y=\"2060\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=\rdate = @answers['Date Required']\rdate = Time.parse(date)+ (60*60*7)\rwhile (date.wday % 7 == 0) or (date.wday % 7 == 6) do\rdate += (1*60*60*24)\rend\rdate.utc.strftime(\"%Y-%m-%dT%H:%M:%SZ\")\r%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"EXAMPLE: Set Start to 7 am prior to date requested\" id=\"utilities_echo_v1_136\" definition_id=\"utilities_echo_v1\" x=\"1420\" y=\"1930\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=\rdate = @answers['Date Required']\rdate = Time.parse(date) - (60*60*17)\rdate.utc.strftime(\"%Y-%m-%dT%H:%M:%SZ\")\r%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"expire extra approvals\" id=\"kinetic_request_approval_expire_v1_70\" definition_id=\"kinetic_request_approval_expire_v1\" x=\"1270\" y=\"1080\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The validation status value that should be set on each of the associated approval submissions.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Expired-another approver approved</parameter>\n        <parameter id=\"originating_id\" tooltip=\"The instance id of an originating Kinetic Request submission.  This value is used to identify the incomplete approval submissions that will be expired.\" label=\"Originating Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_noop_v1_102</task>\n      </dependents>\n    </task>\n    <task name=\"expire extra approvals 2nd Approval\" id=\"kinetic_request_approval_expire_v1_125\" definition_id=\"kinetic_request_approval_expire_v1\" x=\"240\" y=\"1390\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The validation status value that should be set on each of the associated approval submissions.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Expired-another approver approved</parameter>\n        <parameter id=\"originating_id\" tooltip=\"The instance id of an originating Kinetic Request submission.  This value is used to identify the incomplete approval submissions that will be expired.\" label=\"Originating Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"More than 20 days\" value=\"&lt;%=@results['Calculate Duration']['output']%> > 20\">kinetic_request_submission_update_status_v1_124</task>\n        <task type=\"Complete\" label=\"Request 20 days or less\" value=\"&lt;%=@results['Calculate Duration']['output']%> &lt;= 20\">system_noop_v1_141</task>\n      </dependents>\n    </task>\n    <task name=\"expire extra approvals 3rd Approval\" id=\"kinetic_request_approval_expire_v1_126\" definition_id=\"kinetic_request_approval_expire_v1\" x=\"250\" y=\"1780\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The validation status value that should be set on each of the associated approval submissions.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Expired-another approver approved</parameter>\n        <parameter id=\"originating_id\" tooltip=\"The instance id of an originating Kinetic Request submission.  This value is used to identify the incomplete approval submissions that will be expired.\" label=\"Originating Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_noop_v1_141</task>\n      </dependents>\n    </task>\n    <task name=\"expire extra approvals_denial\" id=\"kinetic_request_approval_expire_v1_88\" definition_id=\"kinetic_request_approval_expire_v1\" x=\"1560\" y=\"600\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The validation status value that should be set on each of the associated approval submissions.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Expired-another approver denied</parameter>\n        <parameter id=\"originating_id\" tooltip=\"The instance id of an originating Kinetic Request submission.  This value is used to identify the incomplete approval submissions that will be expired.\" label=\"Originating Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">remedy_emailmessage_create_v2_135</task>\n      </dependents>\n    </task>\n    <task name=\"Format Answers HTML\" id=\"kinetic_request_submission_format_answers_html_v2_123\" definition_id=\"kinetic_request_submission_format_answers_html_v2\" x=\"220\" y=\"120\">\n      <version>2</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"start\" tooltip=\"The menu label of the first question that should be formatted.  If this is left blank, the first question on the service item will be used.\" label=\"Starting Question:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"end\" tooltip=\"The menu label of the last question that should be formatted.  If this is left blank, the last question on the service item will be used.\" label=\"Ending Question:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"include\" tooltip=\"A comma separated list of question menu labels that should be explicitely included in the question list.  Questions included in this list will be included even if they do not exist between the starting and ending questions.  Whitespace matters; ensure there are no spaces after a comma separating the menu labels (unless the question menu label includes a preceding space).\" label=\"Included Questions:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"exclude\" tooltip=\"A comma separated list of question menu labels that should be explicitely excluded in the question list.  Questions included in this list will be excluded even if they exist between the starting and ending questions or are included in the 'Included Question' parameter.  Whitespace matters; ensure there are no spaces after a comma separating the menu labels (unless the question menu label includes a preceding space).\" label=\"Excluded Questions:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Search By Last Name,Contact Search By Last Name</parameter>\n        <parameter id=\"csrvId\" tooltip=\"Instance ID of the survey/request to retrieve answers for\" label=\"Survey/Request Instance ID:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@dataset['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_echo_v1_142</task>\n      </dependents>\n    </task>\n    <task name=\"Get Weekday\" id=\"utilities_echo_v1_124\" definition_id=\"utilities_echo_v1\" x=\"120\" y=\"340\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%= Date.today.wday %&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_echo_v1_123</task>\n      </dependents>\n    </task>\n    <task name=\"ITC Approval\" id=\"kinetic_request_approval_create_v3_86\" definition_id=\"kinetic_request_approval_create_v3\" x=\"880\" y=\"340\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"approver_login\" tooltip=\"The Remedy login name of the approver.\" label=\"Approver Login:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['1st Approval Lookup']['Remedy Login ID']%&gt;</parameter>\n        <parameter id=\"approver_email\" tooltip=\"The email address of the approver.\" label=\"Approver Email:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['1st Approval Lookup']['Email']%&gt;</parameter>\n        <parameter id=\"approver_first_name\" tooltip=\"The first name of the approver.\" label=\"Approver First Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['1st Approval Lookup']['First Name']%&gt;</parameter>\n        <parameter id=\"approver_last_name\" tooltip=\"The last name of the approver.\" label=\"Approver Last Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['1st Approval Lookup']['Last Name']%&gt;</parameter>\n        <parameter id=\"message_template_name\" tooltip=\"The name of the message template to use for the approval.  If no message template is provided an email will not be sent.\" label=\"Message Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"approval_template_catalog_name\" tooltip=\"The name of the catalog the template for approval belongs to.\" label=\"Approval Template Catalog Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['Category']%&gt;</parameter>\n        <parameter id=\"approval_template_name\" tooltip=\"The name of the template to use for the approval.\" label=\"Approval Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">OIS Approve Request</parameter>\n        <parameter id=\"approval_question_label\" tooltip=\"The menu label of the service item question that is used to determine the result of the approval.\" label=\"Approval Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Is this request approved?</parameter>\n        <parameter id=\"approval_value\" tooltip=\"The value that denotes an approval.\" label=\"Approved Value:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Approved</parameter>\n        <parameter id=\"denial_comments_question_label\" tooltip=\"The menu label of the service item question that is used to generate the denial comments.\" label=\"Denial Comments Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Reason for Denial</parameter>\n        <parameter id=\"lookup_id\" tooltip=\"The instance id of the Kinetic Request submission that is being approved.\" label=\"Lookup Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n        <parameter id=\"notes_for_customer\" tooltip=\"Text that can be displayed to customer (typically from the Service Catalog page).  This is stored on the 'Customer Notes' field on the KS_SRV_CustomerSurvey_base form.\" label=\"Notes For Customer:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\">&lt;b&gt;Pending Approval of:&lt;/b&gt; &lt;%=@results['1st Approval Lookup']['Remedy Login ID']%&gt; (&lt;%=@results['1st Approval Lookup']['First Name']%&gt; &lt;%=@results['1st Approval Lookup']['Last Name']%&gt;)</message>\n        <message type=\"Update\"/>\n        <message type=\"Complete\">&lt;b&gt;&lt;%=@results['ITC Approval']['Validation Status']%&gt;&lt;/b&gt;; &lt;%=@results['ITC Approval']['Denial Reason']%&gt;</message>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Denied\" value=\"&quot;&lt;%=@results['ITC Approval']['Validation Status']%>&quot; == &quot;Denied&quot;\">kinetic_request_submission_close_v1_52</task>\n        <task type=\"Complete\" label=\"Approved\" value=\"&quot;&lt;%=@results['ITC Approval']['Validation Status']%>&quot; == &quot;Approved&quot;\">system_loop_tail_v1_64</task>\n      </dependents>\n    </task>\n    <task name=\"Lookup 1st Approvers\" id=\"bmc_itsm7_approver_retrieve_nrc_v3_109\" definition_id=\"bmc_itsm7_approver_retrieve_nrc_v3\" x=\"10\" y=\"230\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"ApproverTypes\" tooltip=\"The type of approver\" label=\"Approver Type\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">ITC COORDINATOR</parameter>\n        <parameter id=\"Services\" tooltip=\"Service --required if approver type is service owner\" label=\"Service\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Organization\" tooltip=\"Organization of approver-required if type is ITC Coordinator\" label=\"Organization\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['ReqFor_Org']%&gt;</parameter>\n        <parameter id=\"Department\" tooltip=\"Deptartment of approver\" label=\"Department\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Short Description\" tooltip=\"Short Description of approver\" label=\"Short Description\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person1\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 1\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['ReqFor_Login ID']%&gt;</parameter>\n        <parameter id=\"person2\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 2\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['Req Login ID']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"1st Approval Not Needed\" value=\"&quot;&lt;%=@results['Lookup 1st Approvers']['match']%>&quot; == &quot;Yes&quot;\">system_noop_v1_102</task>\n        <task type=\"Complete\" label=\"1st Approval Needed\" value=\"&quot;&lt;%=@results['Lookup 1st Approvers']['match']%>&quot; == &quot;No&quot;\">system_noop_v1_111</task>\n      </dependents>\n    </task>\n    <task name=\"Lookup 2nd Approvers\" id=\"bmc_itsm7_approver_retrieve_nrc_v3_113\" definition_id=\"bmc_itsm7_approver_retrieve_nrc_v3\" x=\"260\" y=\"1250\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"ApproverTypes\" tooltip=\"The type of approver\" label=\"Approver Type\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">SERVICE OWNER</parameter>\n        <parameter id=\"Services\" tooltip=\"Service --required if approver type is service owner\" label=\"Service\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Personal Computing</parameter>\n        <parameter id=\"Organization\" tooltip=\"Organization of approver-required if type is ITC Coordinator\" label=\"Organization\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Department\" tooltip=\"Deptartment of approver\" label=\"Department\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Short Description\" tooltip=\"Short Description of approver\" label=\"Short Description\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person1\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 1\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person2\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 2\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_head_v1_114</task>\n      </dependents>\n    </task>\n    <task name=\"Lookup 3rd Approvers\" id=\"bmc_itsm7_approver_retrieve_nrc_v3_131\" definition_id=\"bmc_itsm7_approver_retrieve_nrc_v3\" x=\"250\" y=\"1630\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"ApproverTypes\" tooltip=\"The type of approver\" label=\"Approver Type\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">DSFG COTR</parameter>\n        <parameter id=\"Services\" tooltip=\"Service --required if approver type is service owner\" label=\"Service\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Organization\" tooltip=\"Organization of approver-required if type is ITC Coordinator\" label=\"Organization\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Department\" tooltip=\"Deptartment of approver\" label=\"Department\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Short Description\" tooltip=\"Short Description of approver\" label=\"Short Description\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person1\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 1\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person2\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 2\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_head_v1_130</task>\n      </dependents>\n    </task>\n    <task name=\"Lookup Agency Wide Approvers\" id=\"bmc_itsm7_approver_retrieve_nrc_v3_103\" definition_id=\"bmc_itsm7_approver_retrieve_nrc_v3\" x=\"330\" y=\"590\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"ApproverTypes\" tooltip=\"The type of approver\" label=\"Approver Type\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">AGENCY WIDE</parameter>\n        <parameter id=\"Services\" tooltip=\"Service --required if approver type is service owner\" label=\"Service\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Organization\" tooltip=\"Organization of approver-required if type is ITC Coordinator\" label=\"Organization\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Department\" tooltip=\"Deptartment of approver\" label=\"Department\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Short Description\" tooltip=\"Short Description of approver\" label=\"Short Description\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person1\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 1\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person2\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 2\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_head_v1_104</task>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_echo_v1_152</task>\n      </dependents>\n    </task>\n    <task name=\"Lookup SAMS\" id=\"bmc_itsm7_approver_retrieve_nrc_v3_125\" definition_id=\"bmc_itsm7_approver_retrieve_nrc_v3\" x=\"360\" y=\"830\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"ApproverTypes\" tooltip=\"The type of approver\" label=\"Approver Type\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">SAMS</parameter>\n        <parameter id=\"Services\" tooltip=\"Service --required if approver type is service owner\" label=\"Service\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Organization\" tooltip=\"Organization of approver-required if type is ITC Coordinator\" label=\"Organization\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Department\" tooltip=\"Deptartment of approver\" label=\"Department\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"Short Description\" tooltip=\"Short Description of approver\" label=\"Short Description\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person1\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 1\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"person2\" tooltip=\"If this matches an existing approvers, returns Yes for match\" label=\"Person 2\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">system_loop_head_v1_126</task>\n      </dependents>\n    </task>\n    <task name=\"Notify Contact\" id=\"kinetic_request_email_message_create_v1_143\" definition_id=\"kinetic_request_email_message_create_v1\" x=\"200\" y=\"10\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"to\" tooltip=\"The email address of the target recipient.\" label=\"To:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['Contact_Email']%&gt;</parameter>\n        <parameter id=\"message_template_name\" tooltip=\"The name of the message template that will be used to generate the email message.\" label=\"Message Template Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">OIS Request Submission Notification</parameter>\n        <parameter id=\"originating_id\" tooltip=\"The instance id of an originating Kinetic Request submission.\" label=\"Originating Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"Pending DSFG COTR Approval\" id=\"kinetic_request_submission_update_status_v1_124\" definition_id=\"kinetic_request_submission_update_status_v1\" x=\"230\" y=\"1530\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The value the Validation Status field on the specified Kinetic Request submission record will be set to.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Pending DSFG COTR Approval</parameter>\n        <parameter id=\"submission_id\" tooltip=\"The instance id of the Kinetic Request submission to be updated.\" label=\"Submission Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_retrieve_nrc_v3_131</task>\n      </dependents>\n    </task>\n    <task name=\"Pending Service Owner Approval\" id=\"kinetic_request_submission_update_status_v1_132\" definition_id=\"kinetic_request_submission_update_status_v1\" x=\"290\" y=\"1130\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The value the Validation Status field on the specified Kinetic Request submission record will be set to.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Pending Service Owner Approval</parameter>\n        <parameter id=\"submission_id\" tooltip=\"The instance id of the Kinetic Request submission to be updated.\" label=\"Submission Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_approver_retrieve_nrc_v3_113</task>\n      </dependents>\n    </task>\n    <task name=\"SAMS Approval\" id=\"kinetic_request_approval_create_v3_134\" definition_id=\"kinetic_request_approval_create_v3\" x=\"820\" y=\"980\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"approver_login\" tooltip=\"The Remedy login name of the approver.\" label=\"Approver Login:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['SAMS Approver Lookup']['Remedy Login ID']%&gt;</parameter>\n        <parameter id=\"approver_email\" tooltip=\"The email address of the approver.\" label=\"Approver Email:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['SAMS Approver Lookup']['Email']%&gt;</parameter>\n        <parameter id=\"approver_first_name\" tooltip=\"The first name of the approver.\" label=\"Approver First Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['SAMS Approver Lookup']['First Name']%&gt;</parameter>\n        <parameter id=\"approver_last_name\" tooltip=\"The last name of the approver.\" label=\"Approver Last Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['SAMS Approver Lookup']['Last Name']%&gt;</parameter>\n        <parameter id=\"message_template_name\" tooltip=\"The name of the message template to use for the approval.  If no message template is provided an email will not be sent.\" label=\"Message Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"approval_template_catalog_name\" tooltip=\"The name of the catalog the template for approval belongs to.\" label=\"Approval Template Catalog Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['Category']%&gt;</parameter>\n        <parameter id=\"approval_template_name\" tooltip=\"The name of the template to use for the approval.\" label=\"Approval Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">OIS Approve Request</parameter>\n        <parameter id=\"approval_question_label\" tooltip=\"The menu label of the service item question that is used to determine the result of the approval.\" label=\"Approval Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Is this request approved?</parameter>\n        <parameter id=\"approval_value\" tooltip=\"The value that denotes an approval.\" label=\"Approved Value:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Approved</parameter>\n        <parameter id=\"denial_comments_question_label\" tooltip=\"The menu label of the service item question that is used to generate the denial comments.\" label=\"Denial Comments Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Reason for Denial</parameter>\n        <parameter id=\"lookup_id\" tooltip=\"The instance id of the Kinetic Request submission that is being approved.\" label=\"Lookup Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n        <parameter id=\"notes_for_customer\" tooltip=\"Text that can be displayed to customer (typically from the Service Catalog page).  This is stored on the 'Customer Notes' field on the KS_SRV_CustomerSurvey_base form.\" label=\"Notes For Customer:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\">&lt;b&gt;Pending Approval of:&lt;/b&gt; &lt;%=@results['SAMS Approver Lookup']['Remedy Login ID']%&gt; (&lt;%=@results['SAMS Approver Lookup']['First Name']%&gt; &lt;%=@results['SAMS Approver Lookup']['Last Name']%&gt;)</message>\n        <message type=\"Update\"/>\n        <message type=\"Complete\">&lt;b&gt;&lt;%=@results['SAMS Approval']['Validation Status']%&gt;&lt;/b&gt;; &lt;%=@results['SAMS Approval']['Denial Reason']%&gt;</message>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Approved\" value=\"&quot;&lt;%=@results['SAMS Approval']['Validation Status']%>&quot; == &quot;Approved&quot;\">system_loop_tail_v1_129</task>\n        <task type=\"Complete\" label=\"Denied\" value=\"&quot;&lt;%=@results['SAMS Approval']['Validation Status']%>&quot; == &quot;Denied&quot;\">kinetic_request_submission_close_v1_52</task>\n      </dependents>\n    </task>\n    <task name=\"SAMS Approver Lookup\" id=\"bmc_itsm7_approver_lookup_v2_127\" definition_id=\"bmc_itsm7_approver_lookup_v2\" x=\"820\" y=\"830\">\n      <version>2</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"remedy_login_id\" tooltip=\"The AR Login associated to the CTM People record to retrieve\" label=\"Remedy Login ID\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%= @SAMSappr %&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_approval_create_v3_134</task>\n      </dependents>\n    </task>\n    <task name=\"Send Denial Notification\" id=\"remedy_emailmessage_create_v2_135\" definition_id=\"remedy_emailmessage_create_v2\" x=\"1570\" y=\"720\">\n      <version>2</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"to\" tooltip=\"Email recipient\" label=\"To:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@answers['Contact_Email']%&gt;</parameter>\n        <parameter id=\"subject\" tooltip=\"Email subject text\" label=\"Subject:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Request Denied</parameter>\n        <parameter id=\"mailbox_id\" tooltip=\"AR System Email Mailbox Configuration 'Unique Identifier' (field 179) field value of the desired mailbox.  If not specified, the default mailbox will be used.\" label=\"Mailbox Unique Identifier:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"mailbox_name\" tooltip=\"AR System Email Mailbox Configuration 'Mailbox Name' (field 18139) field value of the desired mailbox.  If not specified, the default mailbox will be used.\" label=\"Mailbox Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"body\" tooltip=\"Email body as HTML\" label=\"Body:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;p&gt;Hello &lt;%=@answers['Contact_First Name']%&gt; &lt;%=@answers['Contact_Last Name']%&gt;,&lt;/p&gt;\r&lt;br&gt;\r&lt;br&gt;\r&lt;p&gt;Service request &lt;%=@dataset['Originating ID-Display']%&gt; has been denied. Please &lt;a href=\"&lt;%=@appconfig['Default Web Server']%&gt;DisplayPage?name=SubmissionsPage\"&gt;View Requests&lt;/a&gt; to see details.&lt;/p&gt;\r&lt;br&gt;\r&lt;br&gt;\r&lt;p&gt;Request Information:&lt;/p&gt;\r&lt;br&gt;\r&lt;p&gt;&lt;%=@dataset['Survey Template Name']%&gt;&lt;/p&gt;\r&lt;br&gt;\r&lt;br&gt;\r&lt;div&gt;&lt;%=@results['Format Answers HTML']['result']%&gt;&lt;/div&gt;\r&lt;br&gt;\r&lt;br&gt;\r&lt;p&gt;Thank you for your support!&lt;/p&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"Service Owner Approval\" id=\"kinetic_request_approval_create_v3_133\" definition_id=\"kinetic_request_approval_create_v3\" x=\"750\" y=\"1390\">\n      <version>3</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>true</visible>\n      <parameters>\n        <parameter id=\"approver_login\" tooltip=\"The Remedy login name of the approver.\" label=\"Approver Login:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['2nd Approval Lookup']['Remedy Login ID']%&gt;</parameter>\n        <parameter id=\"approver_email\" tooltip=\"The email address of the approver.\" label=\"Approver Email:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['2nd Approval Lookup']['Email']%&gt;</parameter>\n        <parameter id=\"approver_first_name\" tooltip=\"The first name of the approver.\" label=\"Approver First Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['2nd Approval Lookup']['First Name']%&gt;</parameter>\n        <parameter id=\"approver_last_name\" tooltip=\"The last name of the approver.\" label=\"Approver Last Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['2nd Approval Lookup']['Last Name']%&gt;</parameter>\n        <parameter id=\"message_template_name\" tooltip=\"The name of the message template to use for the approval.  If no message template is provided an email will not be sent.\" label=\"Message Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n        <parameter id=\"approval_template_catalog_name\" tooltip=\"The name of the catalog the template for approval belongs to.\" label=\"Approval Template Catalog Name:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['Category']%&gt;</parameter>\n        <parameter id=\"approval_template_name\" tooltip=\"The name of the template to use for the approval.\" label=\"Approval Template Name:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">OIS Approve Request</parameter>\n        <parameter id=\"approval_question_label\" tooltip=\"The menu label of the service item question that is used to determine the result of the approval.\" label=\"Approval Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Is this request approved?</parameter>\n        <parameter id=\"approval_value\" tooltip=\"The value that denotes an approval.\" label=\"Approved Value:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Approved</parameter>\n        <parameter id=\"denial_comments_question_label\" tooltip=\"The menu label of the service item question that is used to generate the denial comments.\" label=\"Denial Comments Question Label:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Reason for Denial</parameter>\n        <parameter id=\"lookup_id\" tooltip=\"The instance id of the Kinetic Request submission that is being approved.\" label=\"Lookup Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n        <parameter id=\"notes_for_customer\" tooltip=\"Text that can be displayed to customer (typically from the Service Catalog page).  This is stored on the 'Customer Notes' field on the KS_SRV_CustomerSurvey_base form.\" label=\"Notes For Customer:\" required=\"false\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\"/>\n      </parameters>\n      <messages>\n        <message type=\"Create\">&lt;b&gt;Pending Approval of:&lt;/b&gt; &lt;%=@results['2nd Approval Lookup']['Remedy Login ID']%&gt; (&lt;%=@results['2nd Approval Lookup']['First Name']%&gt; &lt;%=@results['2nd Approval Lookup']['Last Name']%&gt;)</message>\n        <message type=\"Update\"/>\n        <message type=\"Complete\">&lt;b&gt;&lt;%=@results['Service Owner Approval']['Validation Status']%&gt;&lt;/b&gt;; &lt;%=@results['Service Owner Approval']['Denial Reason']%&gt;</message>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Denied\" value=\"&quot;&lt;%=@results['Service Owner Approval']['Validation Status']%>&quot; == &quot;Denied&quot;\">kinetic_request_submission_close_v1_52</task>\n        <task type=\"Complete\" label=\"Approved\" value=\"&quot;&lt;%=@results['Service Owner Approval']['Validation Status']%>&quot; == &quot;Approved&quot;\">system_loop_tail_v1_115</task>\n      </dependents>\n    </task>\n    <task name=\"Set Change Status\" id=\"utilities_echo_v1_98\" definition_id=\"utilities_echo_v1\" x=\"720\" y=\"2040\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;% if @trigger['Message'] == \"Cancelled\" \n%&gt;Cancelled&lt;%\nelse\n%&gt;Complete&lt;%\nend\n%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_submission_close_v1_48</task>\n      </dependents>\n    </task>\n    <task name=\"Set Change Template\" id=\"utilities_eval_v1_74\" definition_id=\"utilities_eval_v1\" x=\"250\" y=\"1920\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"code\" tooltip=\"\" label=\"Code\" required=\"\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">\"Laptop Loaner\"</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_echo_v1_139</task>\n      </dependents>\n    </task>\n    <task name=\"Set End Date\" id=\"utilities_echo_v1_140\" definition_id=\"utilities_echo_v1\" x=\"610\" y=\"1910\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=  date = (Time.parse(@answers['Start Date'] + \"T7:00:00\")) \rwhile (date.wday % 7 == 0) or (date.wday % 7 == 6) do \rdate += (1*60*60*24) \rend \rdate.utc.strftime(\"%Y-%m-%dT%H:%M:%SZ\")%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">bmc_itsm7_change_templated_create_v4_104</task>\n      </dependents>\n    </task>\n    <task name=\"Set New Status_chg\" id=\"kinetic_request_submission_update_status_v1_45\" definition_id=\"kinetic_request_submission_update_status_v1\" x=\"950\" y=\"1920\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The value the Validation Status field on the specified Kinetic Request submission record will be set to.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Processing &lt;%=@results['Change']['Change Number']%&gt;</parameter>\n        <parameter id=\"submission_id\" tooltip=\"The instance id of the Kinetic Request submission to be updated.\" label=\"Submission Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents/>\n    </task>\n    <task name=\"Set Pending 1st Approval\" id=\"kinetic_request_submission_update_status_v1_49\" definition_id=\"kinetic_request_submission_update_status_v1\" x=\"30\" y=\"120\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"validation_status\" tooltip=\"The value the Validation Status field on the specified Kinetic Request submission record will be set to.\" label=\"Validation Status:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">Pending 1st Approval</parameter>\n        <parameter id=\"submission_id\" tooltip=\"The instance id of the Kinetic Request submission to be updated.\" label=\"Submission Id:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@base['CustomerSurveyInstanceId']%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_submission_format_answers_html_v2_123</task>\n      </dependents>\n    </task>\n    <task name=\"Set Start Date\" id=\"utilities_echo_v1_139\" definition_id=\"utilities_echo_v1\" x=\"450\" y=\"1910\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"input\" tooltip=\"\" label=\"Input\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=  date = (Time.parse(@answers['Start Date'] + \"T7:00:00\")) - (1*60*60*24)\rdate.utc.strftime(\"%Y-%m-%dT%H:%M:%SZ\")%&gt;</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">utilities_echo_v1_140</task>\n      </dependents>\n    </task>\n    <task name=\"Start\" id=\"start\" definition_id=\"system_start_v1\" x=\"60\" y=\"10\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>false</defers>\n      <deferrable>false</deferrable>\n      <visible>false</visible>\n      <parameters/>\n      <messages/>\n      <dependents>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_submission_update_status_v1_49</task>\n        <task type=\"Complete\" label=\"\" value=\"\">kinetic_request_email_message_create_v1_143</task>\n      </dependents>\n    </task>\n    <task name=\"Wait before Adding Approvers\" id=\"system_wait_v1_101\" definition_id=\"system_wait_v1\" x=\"340\" y=\"420\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"Time to wait\" tooltip=\"Time you want to wait for deferred task\" label=\"Wait time:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Calculate Wait Days_AGENCY WIDE']['output']%&gt;</parameter>\n        <parameter id=\"Time unit\" tooltip=\"Unit of measurement for time (Minutes, Hours, Days, Weeks)\" label=\"Time unit:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"Minute,Hour,Day,Week\">Day</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Not Approved\" value=\"&quot;&lt;%=@dataset['Validation Status']%>&quot; == &quot;Pending 1st Approval&quot; \">bmc_itsm7_approver_retrieve_nrc_v3_103</task>\n      </dependents>\n    </task>\n    <task name=\"Wait before Adding Approvers_SAM\" id=\"system_wait_v1_153\" definition_id=\"system_wait_v1\" x=\"100\" y=\"830\">\n      <version>1</version>\n      <configured>true</configured>\n      <defers>true</defers>\n      <deferrable>true</deferrable>\n      <visible>false</visible>\n      <parameters>\n        <parameter id=\"Time to wait\" tooltip=\"Time you want to wait for deferred task\" label=\"Wait time:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"\">&lt;%=@results['Calculate Wait Days_SAM']['output']%&gt;</parameter>\n        <parameter id=\"Time unit\" tooltip=\"Unit of measurement for time (Minutes, Hours, Days, Weeks)\" label=\"Time unit:\" required=\"true\" dependsOnId=\"\" dependsOnValue=\"\" menu=\"Minute,Hour,Day,Week\">Day</parameter>\n      </parameters>\n      <messages>\n        <message type=\"Create\"/>\n        <message type=\"Update\"/>\n        <message type=\"Complete\"/>\n      </messages>\n      <dependents>\n        <task type=\"Complete\" label=\"Not approved yet\" value=\"&quot;&lt;%=@dataset['Validation Status']%>&quot; == &quot;Pending 1st Approval&quot;\">bmc_itsm7_approver_retrieve_nrc_v3_125</task>\n      </dependents>\n    </task>\n  </request>\n</taskTree>",
    :description => "Kinetic Task Process Tree",
    :notes => "A new task process"
end